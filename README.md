Paymentmaker — это приложение для автоматизации создания счетов и актов выполненных работ для транспортных услуг. Программа обрабатывает Excel файлы с данными о перевозках и генерирует готовые документы для бухгалтерии.
Возможности

Автоматическая обработка Excel файлов с данными о перевозках
Извлечение информации о маршрутах, водителях, суммах из сложных форматов данных
Генерация счетов и актов в формате Excel с правильным форматированием
Настраиваемые реквизиты компании и заказчика
Предпросмотр данных перед генерацией документов
Современный интерфейс на PyQt6 с поддержкой светлой и темной темы
Drag & Drop для загрузки файлов

Требования

Python 3.8 или выше
Windows, macOS или Linux
Зависимости: PyQt6, pandas, openpyxl, num2words

Установка
Способ 1: Из исходного кода

Клонируйте репозиторий:
bashgit clone https://github.com/yourusername/paymentmaker.git
cd paymentmaker

Создайте виртуальное окружение:
bashpython -m venv venv
source venv/bin/activate  # На Windows: venv\Scripts\activate

Установите зависимости:
bashpip install -r requirements.txt


Способ 2: Установка пакета
bashpip install .
Использование
Запуск приложения
bashpython -m paymentmaker
Или если установлен как пакет:
bashpaymentmaker
Пошаговая инструкция

Запустите приложение

Откроется главное окно программы


Выберите входной файл

Перетащите Excel файл в зону Drag & Drop
Или выберите файл из списка недавних


Укажите параметры счета

Введите номер счета
Программа автоматически определит дату из имени файла или предложит текущую


Просмотрите данные

Нажмите кнопку "Предпросмотр" для проверки корректности обработки данных
В таблице можно редактировать обработанные записи


Создайте документы

Нажмите кнопку "Создать документы"
Выберите место сохранения файла
Программа сгенерирует Excel файл с двумя листами: Счет и Акт


Распечатайте результат

Нажмите кнопку "Печать" для отправки документов на принтер



Настройка реквизитов

Нажмите кнопку "⚙️ Настройки" в верхней части окна
Заполните данные вашей компании и заказчика
Сохраните изменения

Реквизиты сохраняются автоматически и используются при следующих запусках программы.
Формат входных данных
Входной Excel файл должен содержать следующие колонки:

Дата: Дата перевозки в формате ДД.ММ.ГГГГ
Водитель: ФИО водителя
Авто: Информация об автомобиле (должна содержать "Газель" и номер)
Адрес выгрузки: Список адресов доставки (может быть многострочным)
Сумма за рейсы: Стоимость услуги

Формат выходных документов
Программа создает Excel файл с двумя листами:

Счет на оплату - стандартный счет со всеми необходимыми реквизитами
Акт выполненных работ - акт с той же информацией для подписания

Оба документа форматируются для печати на А4 и содержат:

Реквизиты исполнителя и заказчика
Таблицу с услугами
Итоговые суммы
Места для подписей

Особенности интерфейса

Современный дизайн: Интуитивно понятный интерфейс в стиле Material Design
Темная тема: Возможность переключения между светлой и темной темой
Анимированные уведомления: Информативные сообщения о результатах операций
Drag & Drop: Удобная загрузка файлов перетаскиванием
Предпросмотр данных: Возможность просмотра и редактирования обработанных данных

Решение проблем
Ошибка при загрузке файла

Убедитесь, что файл имеет формат .xlsx или .xls
Проверьте наличие обязательных колонок
Убедитесь, что файл не открыт в Excel

Неправильно определяется маршрут

Проверьте формат адресов в колонке "Адрес выгрузки"
Города должны быть написаны полностью или использовать стандартные сокращения

Проблемы с отображением

Установите все зависимости: pip install -r requirements.txt
Убедитесь, что используется Python 3.8 или выше

Разработка
Установка для разработки
bashgit clone https://github.com/yourusername/paymentmaker.git
cd paymentmaker
python -m venv venv
source venv/bin/activate  # На Windows: venv\Scripts\activate
pip install -e .
Создание исполняемого файла
bashpyinstaller --name paymentmaker --windowed --onefile paymentmaker/__main__.py
Лицензия
Проект распространяется под лицензией MIT. Подробности в файле LICENSE.
Автор
Даниил Походняк dan@pohodnyak.ru
История версий
v1.0.0 (2024-12-19)

Полная переработка архитектуры приложения
Переход на PyQt6 для GUI
Улучшена обработка данных
Добавлен предпросмотр данных
Улучшена работа с реквизитами
Исправлены многочисленные ошибки